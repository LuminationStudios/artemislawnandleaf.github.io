<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Public Calendar - Artemis Lawn & Leaf</title>
<link rel="stylesheet" href="css/theme.css"/>
</head>
<body>
<h1 style="text-align:center;">Our Events</h1>
<div id="calendar-container">
  <div id="calendar-nav">
    <button id="prevMonth">&lt; Previous</button>
    <h2 id="monthYear"></h2>
    <button id="nextMonth">Next &gt;</button>
  </div>

  <div class="weekdays">
    <div class="weekday">Sun</div>
    <div class="weekday">Mon</div>
    <div class="weekday">Tue</div>
    <div class="weekday">Wed</div>
    <div class="weekday">Thu</div>
    <div class="weekday">Fri</div>
    <div class="weekday">Sat</div>
  </div>

  <div id="calendar"></div>
</div>

<script>
let events = [];
fetch('data/events.json').then(r=>r.json()).then(d=>{ events = d; init(); }).catch(err=>{ console.error(err); init(); });

let today = new Date();
let currentMonth = today.getMonth();
let currentYear = today.getFullYear();

const calendarDiv = document.getElementById('calendar');
const monthYearHeader = document.getElementById('monthYear');
const prevBtn = document.getElementById('prevMonth');
const nextBtn = document.getElementById('nextMonth');

function daysInMonth(m,y){ return new Date(y,m+1,0).getDate(); }

function renderCalendar(month,year){
  calendarDiv.innerHTML='';
  monthYearHeader.textContent = new Date(year, month).toLocaleString('default',{ month:'long', year:'numeric' });

  const firstDay = new Date(year,month,1).getDay();
  const totalDays = daysInMonth(month,year);

  for(let i=0;i<firstDay;i++) calendarDiv.appendChild(document.createElement('div'));

  for(let day=1;day<=totalDays;day++){
    const dayDiv = document.createElement('div');
    dayDiv.classList.add('day');
    const dateNumber = document.createElement('div');
    dateNumber.classList.add('date-number');
    dateNumber.textContent = day;
    dayDiv.appendChild(dateNumber);
    const currentDate = new Date(year,month,day);
    const dateStr = currentDate.toISOString().split('T')[0];

    if(currentDate.toDateString()===today.toDateString()) dayDiv.classList.add('today');
    if(currentDate < new Date(today.getFullYear(),today.getMonth(),today.getDate())) dayDiv.classList.add('past');

    const dayEvents = events.filter(ev=>ev.date===dateStr);
    dayEvents.forEach(ev=>{
      const evDiv = document.createElement('span');
      evDiv.classList.add('event');
      evDiv.style.backgroundColor = ev.type==='Leaf Cleanup'? '#FF8C42' : ev.type==='Snow Removal'? '#42A5FF' : ev.type==='Closed'? '#db5856' : '#FFD27F';
      evDiv.textContent = ev.title;
      dayDiv.appendChild(evDiv);
    });

    calendarDiv.appendChild(dayDiv);
  }
}

prevBtn.onclick=()=>{ currentMonth--; if(currentMonth<0){currentMonth=11; currentYear--;} renderCalendar(currentMonth,currentYear);}
nextBtn.onclick=()=>{ currentMonth++; if(currentMonth>11){currentMonth=0; currentYear++;} renderCalendar(currentMonth,currentYear);}

function init(){ renderCalendar(currentMonth,currentYear); }
</script>
</body>
</html>
